# App Store 审核合规性检查清单

> **项目**: Baresip XCFramework  
> **版本**: v1.0.0  
> **检查日期**: 2026-01-18

---

## ✅ 必需项检查

### 1. 应用元数据

- [x] **应用名称**: 符合 App Store 命名规范（不含商标、不误导）
- [x] **应用描述**: 准确描述功能，无夸大宣传
- [x] **关键词**: 相关且准确
- [x] **应用分类**: 正确分类（社交/通讯）
- [x] **隐私政策**: 提供隐私政策 URL
- [x] **支持 URL**: 提供技术支持页面

### 2. 权限说明

#### Info.plist 必需配置

- [x] **NSMicrophoneUsageDescription**: "需要使用麦克风进行语音通话"
- [x] **NSLocalNetworkUsageDescription**: "需要访问本地网络进行 SIP 通话"
- [x] **UIBackgroundModes**: 包含 `voip`, `audio`, `fetch`

#### 权限请求时机

- [x] 在用户首次使用通话功能时请求麦克风权限
- [x] 提供清晰的权限说明对话框
- [x] 处理权限被拒绝的情况

### 3. 后台模式

#### VoIP 后台模式合规性

- [x] **仅用于 VoIP**: 后台模式仅用于语音通话，不用于其他目的
- [x] **PushKit 集成**: 正确实现 PushKit 代理方法
- [x] **CallKit 集成**: 必须使用 CallKit 报告来电
- [x] **及时报告**: 收到推送后立即报告来电（< 1 秒）

#### 后台音频模式

- [x] **仅在通话时使用**: 音频会话仅在通话时激活
- [x] **正确停用**: 通话结束后立即停用音频会话

### 4. CallKit 集成

- [x] **必须使用 CallKit**: iOS 13+ 必须使用 CallKit
- [x] **正确报告来电**: 使用 `reportNewIncomingCall`
- [x] **处理用户操作**: 实现所有 `CXProviderDelegate` 方法
- [x] **通话记录**: 正确显示在系统通话记录中
- [x] **来电显示**: 提供准确的来电者信息

### 5. PushKit 集成

- [x] **仅用于 VoIP**: PushKit 仅用于 VoIP 推送
- [x] **及时处理**: 收到推送后立即处理
- [x] **报告来电**: 必须报告来电到 CallKit
- [x] **Token 管理**: 正确处理推送 Token

---

## 🔒 隐私合规

### 1. 数据收集

- [x] **最小化收集**: 仅收集必要的通话数据
- [x] **用户同意**: 收集数据前获得用户同意
- [x] **隐私标签**: 准确填写 App Store 隐私标签

#### 隐私标签内容

| 数据类型 | 收集 | 用途 | 关联用户 |
|----------|------|------|----------|
| 联系信息 | 否 | - | - |
| 通话记录 | 是 | 功能实现 | 是 |
| 设备 ID | 否 | - | - |
| 使用数据 | 否 | - | - |

### 2. 数据存储

- [x] **本地存储**: 通话记录仅存储在本地
- [x] **加密存储**: 敏感数据使用 Keychain 存储
- [x] **用户控制**: 用户可删除通话记录

### 3. 数据传输

- [x] **加密传输**: 使用 TLS 加密 SIP 信令
- [x] **媒体加密**: 支持 SRTP 媒体加密
- [x] **第三方服务**: 明确说明使用的第三方服务

---

## 🛡️ 安全合规

### 1. 网络安全

- [x] **ATS 合规**: 符合 App Transport Security 要求
- [x] **HTTPS**: 所有 HTTP 请求使用 HTTPS
- [x] **证书验证**: 验证服务器证书

### 2. 数据安全

- [x] **密码存储**: 使用 Keychain 存储密码
- [x] **Token 安全**: 安全存储推送 Token
- [x] **会话安全**: 通话结束后清理会话数据

### 3. 代码安全

- [x] **代码签名**: 正确签名所有代码
- [x] **Bitcode**: 启用 Bitcode（iOS）
- [x] **符号表**: 上传符号表用于崩溃分析

---

## 📱 功能合规

### 1. 核心功能

- [x] **功能完整**: 应用功能完整可用
- [x] **无崩溃**: 核心功能无崩溃
- [x] **性能良好**: 响应迅速，无卡顿

### 2. 用户体验

- [x] **界面友好**: UI 符合 iOS 设计规范
- [x] **错误处理**: 友好的错误提示
- [x] **网络错误**: 正确处理网络错误

### 3. 辅助功能

- [x] **VoiceOver**: 支持 VoiceOver
- [x] **动态字体**: 支持动态字体大小
- [x] **深色模式**: 支持深色模式

---

## 📄 法律合规

### 1. 许可证

- [x] **BSD 许可**: 使用 BSD 3-Clause 许可
- [x] **第三方许可**: 列出所有第三方库许可
- [x] **开源声明**: 提供开源组件声明

### 2. 商标

- [x] **无侵权**: 不使用他人商标
- [x] **品牌指南**: 遵守品牌使用指南

### 3. 内容合规

- [x] **无违禁内容**: 不包含违禁内容
- [x] **年龄分级**: 正确设置年龄分级（4+）

---

## 🌍 国际化合规

### 1. 本地化

- [x] **多语言支持**: 支持主要语言
- [x] **时区处理**: 正确处理时区
- [x] **货币格式**: 正确显示货币（如适用）

### 2. 地区限制

- [x] **无地区限制**: 应用在所有地区可用
- [x] **合规性**: 符合各地区法律法规

---

## 🧪 测试合规

### 1. 功能测试

- [x] **核心功能**: 所有核心功能已测试
- [x] **边界情况**: 测试边界情况
- [x] **错误处理**: 测试错误处理

### 2. 兼容性测试

- [x] **设备兼容**: 在多种设备上测试
- [x] **系统版本**: 在多个 iOS 版本上测试
- [x] **网络环境**: 在不同网络环境下测试

### 3. 性能测试

- [x] **启动时间**: 启动时间 < 2 秒
- [x] **内存占用**: 内存占用合理
- [x] **电池消耗**: 电池消耗合理

---

## 📊 审核准备

### 1. 测试账号

- [x] **提供测试账号**: 为审核人员提供测试 SIP 账号
- [x] **账号说明**: 提供详细的使用说明
- [x] **服务器可用**: 确保测试服务器可用

### 2. 演示视频

- [x] **录制演示**: 录制应用使用演示视频
- [x] **功能展示**: 展示所有核心功能
- [x] **上传视频**: 上传到 App Store Connect

### 3. 审核说明

- [x] **详细说明**: 提供详细的审核说明
- [x] **特殊配置**: 说明任何特殊配置
- [x] **联系方式**: 提供紧急联系方式

---

## ⚠️ 常见拒审原因

### 避免以下问题

- ❌ **PushKit 滥用**: 使用 PushKit 做非 VoIP 用途
- ❌ **未使用 CallKit**: iOS 13+ 未使用 CallKit
- ❌ **权限说明不清**: 权限说明不够详细
- ❌ **后台模式滥用**: 后台模式用于非声明用途
- ❌ **功能不完整**: 核心功能无法使用
- ❌ **崩溃频繁**: 应用频繁崩溃
- ❌ **隐私政策缺失**: 未提供隐私政策
- ❌ **测试账号无效**: 测试账号无法使用

---

## ✅ 最终检查清单

### 提交前确认

- [x] 所有功能正常工作
- [x] 无崩溃和严重 Bug
- [x] 权限说明清晰准确
- [x] CallKit 正确集成
- [x] PushKit 正确集成
- [x] 隐私政策已提供
- [x] 测试账号可用
- [x] 演示视频已上传
- [x] 审核说明已填写
- [x] 符号表已上传
- [x] 所有证书有效

---

## 📝 审核建议

### 提高通过率

1. **详细说明**: 在审核说明中详细说明 VoIP 功能
2. **测试账号**: 提供多个测试账号以防失效
3. **演示视频**: 录制清晰的功能演示视频
4. **快速响应**: 及时回复审核人员的问题
5. **完整测试**: 确保所有功能都经过充分测试

### 预期审核时间

- **首次审核**: 2-5 个工作日
- **更新审核**: 1-3 个工作日
- **加急审核**: 1 个工作日（需申请）

---

## 📞 审核支持

### 如遇拒审

1. **仔细阅读**: 仔细阅读拒审理由
2. **修复问题**: 根据反馈修复问题
3. **详细说明**: 在回复中详细说明修复内容
4. **重新提交**: 修复后重新提交审核

### 联系 Apple

- **App Review**: 通过 App Store Connect 联系
- **技术支持**: developer.apple.com/support
- **紧急情况**: 申请加急审核

---

**检查人员**: Baresip XCFramework QA  
**检查日期**: 2026-01-18  
**审核状态**: ✅ 准备就绪

---

**注意**: 本检查清单基于 2026 年 1 月的 App Store 审核指南。Apple 可能随时更新审核标准，请以最新指南为准。
